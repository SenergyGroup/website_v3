{{ define "main" }}

<article class="blog-post">

    <div class="post-header">
        <h1 class="post-title">{{ .Title }}</h1>
        <p class="subtitle">{{ .Params.subtitle }}</p>

        <div class="meta">
            <span class="dateu">{{ .Params.lastmod.Format "January 2, 2006" }}</span>
        </div>
    </div>

    <div class="post-content">
        {{ .Content }}
    </div>

</article>

<div class="nav-buttons">
    {{ $current := . }}
    {{ $sections := split $current.RelPermalink "/" }}
    {{ $backURL := "" }}

    {{ if (eq (len $sections) 5) }}
        {{ $backURL = print "/blog/" (index $sections 2) "/" }}
    {{ else if (eq (len $sections) 4) }}
        {{ $backURL = "/blog/" }}
    {{ end }}
    <div class="nav-back" onclick="location.href='{{ $backURL }}';">
        Return to Blog
    </div>
    {{ $current := . }}
    {{ $next := .NextInSection }}
    {{ if $next }}
        <div class="nav-next" onclick="location.href='{{ $next.Permalink }}';">
            Next Post
        </div>
    {{ end }}
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const currentUrl = window.location.href;
        document.querySelectorAll('a[target="_blank"]').forEach(link => {
            link.href = link.href.replace('YOUR_POST_LINK', encodeURIComponent(currentUrl));
        });
    });
</script>

{{ end }}
